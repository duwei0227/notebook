<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MySQL数据库表关联</title>
    <link href="/2022/01/19/2022-01-19-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%85%B3%E8%81%94/"/>
    <url>/2022/01/19/2022-01-19-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%85%B3%E8%81%94/</url>
    
    <content type="html"><![CDATA[<pre><code>在实际业务项目中经常会存在不同的业务表进行关联查询的需要，本文从如下几个方式讲解。</code></pre><h3 id="1、where"><a href="#1、where" class="headerlink" title="1、where"></a>1、where</h3><p>语法格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">from</span> a, b <span class="hljs-keyword">where</span> a.id <span class="hljs-operator">=</span> b.id<br></code></pre></td></tr></table></figure><p><code>where</code>使用a表和b表的一个或者多个字段进行数据关联，如果关联时其中一方没有符合条件的记录，那么查询结果返回为空</p><h4 id="1-1-a和b有一条记录匹配"><a href="#1-1-a和b有一条记录匹配" class="headerlink" title="1.1 a和b有一条记录匹配"></a>1.1 a和b有一条记录匹配</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a, b <span class="hljs-keyword">where</span> a.id <span class="hljs-operator">=</span> b.id <span class="hljs-keyword">and</span> a.id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+----+-----+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+----+-----+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> C   <span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> D   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+----+-----+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><h4 id="1-2-a和b表数据量不匹配"><a href="#1-2-a和b表数据量不匹配" class="headerlink" title="1.2 a和b表数据量不匹配"></a>1.2 a和b表数据量不匹配</h4><p>当a和b表匹配条件的数据量不一致时，所有符合条件的记录都会返回;数据量少的一方会将结果进行复制拼接返回到客户端</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a, b <span class="hljs-keyword">where</span> a.id <span class="hljs-operator">=</span> b.id <span class="hljs-keyword">and</span> a.id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+----+-----+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+----+-----+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> B   <span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> A   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> A   <span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> A   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+----+-----+</span><br><span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure><h4 id="1-3-无匹配的记录"><a href="#1-3-无匹配的记录" class="headerlink" title="1.3 无匹配的记录"></a>1.3 无匹配的记录</h4><p>当根据条件匹配查询无记录时，<code>MySQL</code>不会返回任何记录</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a, b <span class="hljs-keyword">where</span> a.id <span class="hljs-operator">=</span> b.id <span class="hljs-keyword">and</span> b.id <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br><span class="hljs-keyword">Empty</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><h3 id="2、左关联left-join"><a href="#2、左关联left-join" class="headerlink" title="2、左关联left join"></a>2、左关联left join</h3><p>语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">xxx <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> yyy <span class="hljs-keyword">on</span> <br></code></pre></td></tr></table></figure><p><code>left join</code>以左边表为驱动表(主表)，在进行数据匹配时，驱动表的记录只要符合查询条件都会返回，从表的记录如果符合查询条件会拼接到结果集右边，如果没有记录匹配设置字段值为<code>NULL</code>拼接到结果集右边返回到客户端</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> t1.<span class="hljs-operator">*</span>, t2.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a t1 <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> b t2 <span class="hljs-keyword">on</span> t1.id <span class="hljs-operator">=</span> t2.id <span class="hljs-keyword">where</span> t1.id <span class="hljs-keyword">in</span> (<span class="hljs-number">2</span>, <span class="hljs-number">4</span>);<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+------+------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span> id   <span class="hljs-operator">|</span> var  <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+------+------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> C   <span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span> D    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> F   <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+------+------+</span><br><span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><h3 id="3、右关联-right-join"><a href="#3、右关联-right-join" class="headerlink" title="3、右关联 right join"></a>3、右关联 right join</h3><p>语法格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">xxx <span class="hljs-keyword">right</span> <span class="hljs-keyword">join</span> yyy <span class="hljs-keyword">on</span> <br></code></pre></td></tr></table></figure><p><code>right join</code>和<code>left join</code>原理类似，只是驱动表是右边表,同样的优先匹配驱动表记录，驱动表的记录只要符合查询条件都会返回，从表的记录如果符合查询条件会拼接到结果集左边，如果没有记录匹配设置字段值为<code>NULL</code>拼接到结果集左边返回到客户端</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> t1.<span class="hljs-operator">*</span>, t2.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a t1 <span class="hljs-keyword">right</span> <span class="hljs-keyword">join</span> b t2 <span class="hljs-keyword">on</span> t1.id <span class="hljs-operator">=</span> t2.id <span class="hljs-keyword">where</span> t2.id <span class="hljs-keyword">in</span> (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+----+-----+</span><br><span class="hljs-operator">|</span> id   <span class="hljs-operator">|</span> var  <span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+----+-----+</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span> C    <span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> D   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span>  <span class="hljs-number">3</span> <span class="hljs-operator">|</span> E   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+----+-----+</span><br><span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><h3 id="4、union并集关联"><a href="#4、union并集关联" class="headerlink" title="4、union并集关联"></a>4、union并集关联</h3><p>语法格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> xxx <span class="hljs-keyword">from</span> a <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> yyy <span class="hljs-keyword">from</span> b; <br></code></pre></td></tr></table></figure><p><code>union</code>操作不需要<code>left join</code>或<code>right join</code>的<code>on</code>进行条件关联，但是查询结果字段位数需要一一对应，<code>union</code>操作会将结果集进行纵向合并返回;各自的<code>sql</code>语句独立可以有自己的<code>where</code>条件</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> t1.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a t1 <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> t2.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> b t2;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> A   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> B   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> C   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> F   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> D   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">3</span> <span class="hljs-operator">|</span> E   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+</span><br><span class="hljs-number">6</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure><p>查询子句包含<code>where</code>条件：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> t1.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a t1 <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> t2.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> b t2 <span class="hljs-keyword">where</span> t2.id <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>    <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> ;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> var <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> A   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> B   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> C   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> F   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----+</span><br><span class="hljs-number">4</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><h3 id="5、附录"><a href="#5、附录" class="headerlink" title="5、附录"></a>5、附录</h3><h4 id="5-1-建表语句"><a href="#5-1-建表语句" class="headerlink" title="5.1 建表语句"></a>5.1 建表语句</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> a (<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    val <span class="hljs-type">varchar</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span><br>);<br><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> b(<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    val <span class="hljs-type">varchar</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span><br>);<br></code></pre></td></tr></table></figure><h4 id="5-2-初始数据"><a href="#5-2-初始数据" class="headerlink" title="5.2 初始数据"></a>5.2 初始数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> a <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;A&#x27;</span>), (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;B&#x27;</span>), (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;C&#x27;</span>), (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;F&#x27;</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> b <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;A&#x27;</span>), (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;D&#x27;</span>), (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;E&#x27;</span>);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Python获取本机IP地址和Mac地址</title>
    <link href="/2022/01/07/2021-12-23-Python%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BAip%E5%9C%B0%E5%9D%80%E5%92%8CMac%E5%9C%B0%E5%9D%80/"/>
    <url>/2022/01/07/2021-12-23-Python%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BAip%E5%9C%B0%E5%9D%80%E5%92%8CMac%E5%9C%B0%E5%9D%80/</url>
    
    <content type="html"><![CDATA[<h3 id="1、获取IP地址"><a href="#1、获取IP地址" class="headerlink" title="1、获取IP地址"></a>1、获取IP地址</h3><p>此方法在<code>Windows</code>和<code>Linux</code>下都适用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<br><br><span class="hljs-keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM) <span class="hljs-keyword">as</span> client:<br>    client.connect((<span class="hljs-string">&#x27;8.8.8.8&#x27;</span>, <span class="hljs-number">80</span>))<br>    ip = client.getsockname()[<span class="hljs-number">0</span>]<br>    <br></code></pre></td></tr></table></figure><h3 id="2、获取MAC地址"><a href="#2、获取MAC地址" class="headerlink" title="2、获取MAC地址"></a>2、获取MAC地址</h3><p>目前暂未找到合适的获取mac地址的方法，在一些博客上找到的都是不准确的</p><p>暂时采用第三方库 <code>getmac</code> 获取</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install getmac<br></code></pre></td></tr></table></figure><p>获取mac地址：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> getmac<br><br>getmac.get_mac_address()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>解决Chrome浏览器默认https访问</title>
    <link href="/2021/12/23/2021-12-23-%E8%A7%A3%E5%86%B3Chrome%E6%B5%8F%E8%A7%88%E5%99%A8%E9%BB%98%E8%AE%A4https%E9%97%AE%E9%A2%98/"/>
    <url>/2021/12/23/2021-12-23-%E8%A7%A3%E5%86%B3Chrome%E6%B5%8F%E8%A7%88%E5%99%A8%E9%BB%98%E8%AE%A4https%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h3 id="1、背景"><a href="#1、背景" class="headerlink" title="1、背景"></a>1、背景</h3><p>Chrome新版浏览器在访问网址时会默认添加http，对于一部分未支持https或者公司内部的项目来说很不友好</p><h3 id="2、解决方案"><a href="#2、解决方案" class="headerlink" title="2、解决方案"></a>2、解决方案</h3><h4 id="2-1-方案一"><a href="#2-1-方案一" class="headerlink" title="2.1 方案一"></a>2.1 方案一</h4><p>在Chrome浏览器地址栏输入以下内容：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">chrome:<span class="hljs-regexp">//</span>net-internals/<span class="hljs-comment">#hsts</span><br></code></pre></td></tr></table></figure><p><img src="/img/chrome-url-address.png"></p><p>找到 <code>Delete domain security policies</code><br>在<code>Domain</code>栏中输入需要删除的域名后点击<code>delete</code><br><img src="/img/chrome-delete-domain.png"></p>]]></content>
    
    
    <categories>
      
      <category>其他</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Http接口参数下划线转为驼峰式</title>
    <link href="/2021/12/06/2021-12-06-Http%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E4%B8%8B%E5%88%92%E7%BA%BF%E8%BD%AC%E4%B8%BA%E9%A9%BC%E5%B3%B0%E5%BC%8F/"/>
    <url>/2021/12/06/2021-12-06-Http%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E4%B8%8B%E5%88%92%E7%BA%BF%E8%BD%AC%E4%B8%BA%E9%A9%BC%E5%B3%B0%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p>Http接口参数下划线转为驼峰式</p><h3 id="1、背景"><a href="#1、背景" class="headerlink" title="1、背景"></a>1、背景</h3><p class="note note-info">Spring Boot项目</p>1、第三方系统接口参数格式为下划线形式,例如 `access_token`2、我方系统要求字段属性格式为驼峰式(或sonar要求)<h3 id="2、整体处理方式"><a href="#2、整体处理方式" class="headerlink" title="2、整体处理方式"></a>2、整体处理方式</h3><p>在对应实体类层级增加<code>JsonNaming</code>注解，同时属性字段定义为驼峰式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.PropertyNamingStrategy;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.annotation.JsonNaming;<br><br><span class="hljs-meta">@JsonNaming(value = PropertyNamingStrategy.SnakeCaseStrategy.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Token</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String appAccessToken<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>JavaScript知识点</title>
    <link href="/2021/12/06/2019-02-03-js-userless/"/>
    <url>/2021/12/06/2019-02-03-js-userless/</url>
    
    <content type="html"><![CDATA[<p>JavaScript知识点</p><h3 id="1、对象深拷贝-也可以用于合并"><a href="#1、对象深拷贝-也可以用于合并" class="headerlink" title="1、对象深拷贝,也可以用于合并"></a>1、对象深拷贝,也可以用于合并</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">$.extent(dest_obj, src_obj)<br></code></pre></td></tr></table></figure><h3 id="2、base64编码"><a href="#2、base64编码" class="headerlink" title="2、base64编码"></a>2、base64编码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//编码</span><br><span class="hljs-built_in">window</span>.btoa(<span class="hljs-string">&#x27;base64)   // YmFzZTY0</span><br><span class="hljs-string"></span><br><span class="hljs-string">//解码</span><br><span class="hljs-string">window.atob(&#x27;</span>YmFzZTY0)  <span class="hljs-comment">// base64</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Java知识点</title>
    <link href="/2021/12/06/2019-02-02-java/"/>
    <url>/2021/12/06/2019-02-02-java/</url>
    
    <content type="html"><![CDATA[<p>Java知识点</p><h3 id="1、Hibernate框架mysql数据库id主键自增"><a href="#1、Hibernate框架mysql数据库id主键自增" class="headerlink" title="1、Hibernate框架mysql数据库id主键自增"></a>1、Hibernate框架mysql数据库id主键自增</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span><br><span class="hljs-meta">@GenericGenerator(name = &quot;mySeq&quot;, strategy = &quot;increment&quot; )</span><br></code></pre></td></tr></table></figure><h3 id="2、Spring-Security去掉默认认证"><a href="#2、Spring-Security去掉默认认证" class="headerlink" title="2、Spring Security去掉默认认证"></a>2、Spring Security去掉默认认证</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"># spring boot <span class="hljs-number">2.</span>x<br><span class="hljs-meta">@SpringBootApplication(exclude = &#123;SecurityAutoConfiguration.class, ManagementWebSecurityAutoConfiguration.class&#125;)</span><br></code></pre></td></tr></table></figure><h3 id="3、字符串替换-或者"><a href="#3、字符串替换-或者" class="headerlink" title="3、字符串替换 $ 或者 \"></a>3、字符串替换 $ 或者 \</h3><h4 id="3-1-单个-符号-使用replace替换-–-能实现替换"><a href="#3-1-单个-符号-使用replace替换-–-能实现替换" class="headerlink" title="3.1 单个 $ 符号, 使用replace替换 – 能实现替换"></a>3.1 单个 $ 符号, 使用<code>replace</code>替换 – <strong>能实现替换</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String singleDollar = <span class="hljs-string">&quot;abc$sef&quot;</span>;<br>System.out.println(singleDollar.replace(<span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;\\$\\&quot;</span>));<br>System.out.println(singleDollar.replace(<span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>));<br><br><span class="hljs-comment">// 输出结果</span><br>abc\$\sef<br>abc_sef<br></code></pre></td></tr></table></figure><h4 id="3-2-多个-符号，使用replaceAll替换-–-未能完成替换"><a href="#3-2-多个-符号，使用replaceAll替换-–-未能完成替换" class="headerlink" title="3.2 多个 $ 符号，使用replaceAll替换 – 未能完成替换"></a>3.2 多个 $ 符号，使用<code>replaceAll</code>替换 – <strong>未能完成替换</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String multiDollar = <span class="hljs-string">&quot;abc$edf$mgl&quot;</span>;<br>System.out.println(multiDollar.replaceAll(<span class="hljs-string">&quot;\\\\$&quot;</span>, <span class="hljs-string">&quot;\\\\$\\\\&quot;</span>));<br>System.out.println(multiDollar.replaceAll(<span class="hljs-string">&quot;\\\\$&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>));<br><br><span class="hljs-comment">// 输出结果</span><br>abc$edf$mgl<br>abc$edf$mgl<br></code></pre></td></tr></table></figure><h4 id="3-3-多个-符号，使用Matcher-quoteReplacement替换-–-完成替换且不需要太多的转义，推荐"><a href="#3-3-多个-符号，使用Matcher-quoteReplacement替换-–-完成替换且不需要太多的转义，推荐" class="headerlink" title="3.3 多个 $ 符号，使用Matcher.quoteReplacement替换  – 完成替换且不需要太多的转义，推荐"></a>3.3 多个 $ 符号，使用<code>Matcher.quoteReplacement</code>替换  – <strong>完成替换且不需要太多的转义，推荐</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String multiDollar = <span class="hljs-string">&quot;abc$edf$mgl&quot;</span>;<br>System.out.println(multiDollar.replaceAll(Matcher.quoteReplacement(<span class="hljs-string">&quot;$&quot;</span>), Matcher.quoteReplacement(<span class="hljs-string">&quot;\\$\\&quot;</span>)));<br>System.out.println(multiDollar.replaceAll(Matcher.quoteReplacement(<span class="hljs-string">&quot;$&quot;</span>), Matcher.quoteReplacement(<span class="hljs-string">&quot;_&quot;</span>)));<br><br><span class="hljs-comment">// 输出结果</span><br>abc\$\edf\$\mgl<br>abc_edf_mgl<br></code></pre></td></tr></table></figure><h4 id="3-4-单个-符号，使用replace替换-–-完成替换"><a href="#3-4-单个-符号，使用replace替换-–-完成替换" class="headerlink" title="3.4 单个 $ 符号，使用replace替换 – 完成替换"></a>3.4 单个 $ 符号，使用<code>replace</code>替换 – <strong>完成替换</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String singleSlash = <span class="hljs-string">&quot;abc\\abc&quot;</span>;<br>System.out.println(singleSlash.replace(<span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;\\\\&quot;</span>));<br>System.out.println(singleSlash.replace(<span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>));<br><br><span class="hljs-comment">// 输出结果</span><br>abc\\abc<br>abc_abc<br></code></pre></td></tr></table></figure><h4 id="3-5-多个-符号，使用replaceAll替换-–-可以替换"><a href="#3-5-多个-符号，使用replaceAll替换-–-可以替换" class="headerlink" title="3.5 多个 $ 符号，使用replaceAll替换 – 可以替换"></a>3.5 多个 $ 符号，使用<code>replaceAll</code>替换 – <strong>可以替换</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String multiSlash = <span class="hljs-string">&quot;abc\\edf\\mgl&quot;</span>;<br>System.out.println(multiSlash.replaceAll(<span class="hljs-string">&quot;\\\\&quot;</span>, <span class="hljs-string">&quot;\\\\\\\\&quot;</span>));<br>System.out.println(multiSlash.replaceAll(<span class="hljs-string">&quot;\\\\&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>));<br><br><span class="hljs-comment">// 输出结果</span><br>abc\\edf\\mgl<br>abc_edf_mgl<br></code></pre></td></tr></table></figure><h4 id="3-6-多个-符号，使用Matcher-quoteReplacement替换-–-可以替换-推荐"><a href="#3-6-多个-符号，使用Matcher-quoteReplacement替换-–-可以替换-推荐" class="headerlink" title="3.6 多个 $ 符号，使用Matcher.quoteReplacement替换 – 可以替换,推荐"></a>3.6 多个 $ 符号，使用<code>Matcher.quoteReplacement</code>替换 – <strong>可以替换,推荐</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String multiSlash = <span class="hljs-string">&quot;abc\\edf\\mgl&quot;</span>;<br>System.out.println(multiSlash.replaceAll(Matcher.quoteReplacement(<span class="hljs-string">&quot;\\&quot;</span>), Matcher.quoteReplacement(<span class="hljs-string">&quot;\\\\&quot;</span>)));<br>System.out.println(multiSlash.replaceAll(Matcher.quoteReplacement(<span class="hljs-string">&quot;\\&quot;</span>), Matcher.quoteReplacement(<span class="hljs-string">&quot;_&quot;</span>)));<br><br><span class="hljs-comment">// 输出结果</span><br>abc\\edf\\mgl<br>abc_edf_mgl<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>使用Python操作MySql</title>
    <link href="/2021/12/06/2010-01-12-python%E6%93%8D%E4%BD%9Cmysql/"/>
    <url>/2021/12/06/2010-01-12-python%E6%93%8D%E4%BD%9Cmysql/</url>
    
    <content type="html"><![CDATA[<p>使用Python操作MySql</p><h3 id="一、准备"><a href="#一、准备" class="headerlink" title="一、准备"></a>一、准备</h3><ul><li>python <code>3.7.4 docker</code></li><li>mysql <code>Ver 8.0.18 for Linux on x86_64</code> docker</li><li>PyMySQL <code>pip install PyMySQL</code></li></ul><h3 id="二、注意事项"><a href="#二、注意事项" class="headerlink" title="二、注意事项"></a>二、注意事项</h3><ul><li>mysql host需要使用docker容器内部分配的ip(使用 <code>ifconfig</code>查看) – idea可以直接使用<code>localhost:映射端口</code>连接，有一定误导</li><li>事务不会自动提交，需要主动控制 <code>commit</code>或<code>rollback</code></li><li><code>drop</code>操作需要数据表实际存在（<code>drop table if exists user</code>）</li><li><code>create table</code>中<code>int(10)</code>在创建后的数据库表中字段大小<strong>10</strong>已经丢失，在当前数据库版本中会有警告</li><li>实际值大小要和字段匹配</li><li>占位符使用<code>%s</code>,参数使用元组(<code>(p,)</code>)</li><li>连接关闭建议使用<code>with</code>上下文管理，保证资源释放</li></ul><h3 id="三、主要代码"><a href="#三、主要代码" class="headerlink" title="三、主要代码"></a>三、主要代码</h3><h4 id="1、连接"><a href="#1、连接" class="headerlink" title="1、连接"></a>1、连接</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">self.db = pymysql.connect(host=self.host,<br>                                      user=self.user,<br>                                      password=self.password,<br>                                      database=self.database,<br>                                      port=self.port,<br>                                      charset=self.charset,<br>                                      cursorclass=self.cursorclass)<br>self.cursor = self.db.cursor()<br></code></pre></td></tr></table></figure><h4 id="2、执行execute"><a href="#2、执行execute" class="headerlink" title="2、执行execute"></a>2、执行<code>execute</code></h4><p><code>execute</code> 返回命中记录数<br>通过<code>cursor.fetchone</code>、<code>fetchall</code>、<code>fetchmany(size)</code>获取实际数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">select_sql = <span class="hljs-string">&#x27;select id, name, cellphone, balance, create_time, status from user where id = %s&#x27;</span><br><br>data_id = <span class="hljs-number">5</span>  <span class="hljs-comment"># 在insert完成结果中返回是最好的,待解决</span><br>cursor.execute(select_sql, (data_id, ))<br>result = cursor.fetchone()  <span class="hljs-comment"># 返回为dict, 一条</span><br><span class="hljs-comment"># result = cursor.fetchall()  # 返回为dict，全部</span><br><span class="hljs-comment"># result = cursor.fetchmany(size=5)  # 返回为dict，指定大小</span><br></code></pre></td></tr></table></figure><h4 id="3、事务"><a href="#3、事务" class="headerlink" title="3、事务"></a>3、事务</h4><p>此处使用数据库<code>connect</code>操作事务</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">self.connect.commit()<br>self.connect.rollback()<br></code></pre></td></tr></table></figure><h4 id="4、连接关闭"><a href="#4、连接关闭" class="headerlink" title="4、连接关闭"></a>4、连接关闭</h4><p>先关闭<code>cursor</code>在关闭<code>connect</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">cursor.close()<br>connect.close()<br></code></pre></td></tr></table></figure><p>参考：<br><a href="https://www.runoob.com/python3/python3-mysql.html">菜鸟教程</a></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Java普通类操作Spring Bean</title>
    <link href="/2021/12/06/2019-07-11-java%E6%99%AE%E9%80%9A%E7%B1%BB%E6%93%8D%E4%BD%9Cspring%20bean/"/>
    <url>/2021/12/06/2019-07-11-java%E6%99%AE%E9%80%9A%E7%B1%BB%E6%93%8D%E4%BD%9Cspring%20bean/</url>
    
    <content type="html"><![CDATA[<p>Java普通类操作Spring Bean</p><p>基于spring boot 1.5.6版本<br>synchronized 防止实例同时访问修改</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringBeanTool</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationContextAware</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ApplicationContext applicationContext = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setApplicationContext</span><span class="hljs-params">(ApplicationContext applicationContext)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (SpringBeanTool.applicationContext == <span class="hljs-keyword">null</span>) &#123;<br>            SpringBeanTool.applicationContext = applicationContext;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> ApplicationContext <span class="hljs-title">getApplicationContext</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> applicationContext;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title">getBean</span><span class="hljs-params">(Class clazz)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> getApplicationContext().getBean(clazz);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SQL知识点</title>
    <link href="/2021/12/06/2019-03-04-sql/"/>
    <url>/2021/12/06/2019-03-04-sql/</url>
    
    <content type="html"><![CDATA[<p>SQL知识点记录</p><h3 id="1、Oracle查询支持正则化"><a href="#1、Oracle查询支持正则化" class="headerlink" title="1、Oracle查询支持正则化"></a>1、Oracle查询支持正则化</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> job <span class="hljs-keyword">where</span> regexp_like(name, <span class="hljs-string">&#x27;^[0-9]+&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="2、MySql索引相关"><a href="#2、MySql索引相关" class="headerlink" title="2、MySql索引相关"></a>2、MySql索引相关</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 查询表索引<br><span class="hljs-keyword">show</span> index <span class="hljs-keyword">from</span> table_name;<br><br># 创建索引<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> table_name <span class="hljs-keyword">add</span> <span class="hljs-keyword">unique</span> index (column_name);<br># 追加索引之前需要删除旧的索引，使用如下方式重新创建，否则索引不生效<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> table_name <span class="hljs-keyword">add</span> <span class="hljs-keyword">unique</span> index (column_old_index, column_new_index);<br><br># 删除索引<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> table_name <span class="hljs-keyword">drop</span> index column_name;<br></code></pre></td></tr></table></figure><h3 id="3、删除column"><a href="#3、删除column" class="headerlink" title="3、删除column"></a>3、删除column</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> table_name <span class="hljs-keyword">drop</span> <span class="hljs-keyword">column</span> column_name;<br></code></pre></td></tr></table></figure><h3 id="4、Mysql-字符串格式日期转换"><a href="#4、Mysql-字符串格式日期转换" class="headerlink" title="4、Mysql 字符串格式日期转换"></a>4、Mysql 字符串格式日期转换</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">str_to_date(date, format)<br>%Y:年<br>%m:月<br>%d:天<br>%H:时<br>%i:分<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>SQL</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Java单元测试</title>
    <link href="/2021/12/06/2019-09-27-Java%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"/>
    <url>/2021/12/06/2019-09-27-Java%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<p>Java单元测试</p><p>单元测试：只测试系统中最原子化的行为单元的自动化测试–测试核心逻辑</p><p>简单设计4原则：</p><blockquote><p>测试变绿–测试通过<br>没有重复–代码没有重复<br>揭示意图–测试什么功能<br>最少元素  </p></blockquote><p>单元测试策略：变红(单元测试)-&gt;变绿(烂代码)-&gt;重构(优化)</p><h3 id="测试替身"><a href="#测试替身" class="headerlink" title="测试替身"></a>测试替身</h3><blockquote><p>SUT System Under Test<br>DOC Dependence On Component</p></blockquote><h3 id="Mockito"><a href="#Mockito" class="headerlink" title="Mockito"></a>Mockito</h3><ul><li>Mock – 不关心数据的输入和输出，验证mock的方法是否被调用过<ul><li>验证行为</li><li>屏蔽行为</li></ul></li><li>Stub – 数据的伪造，替换真实数据<ul><li>状态模拟</li></ul></li><li>Spy<ul><li>假中有真</li></ul></li></ul><p>采用Mockito和PowerMockito进行单元测试<br>以下单元测试案例执行基于：<br>Spring Boot 1.5.6.RELEASE<br>Mockito 2.25.1<br>PowerMockito 2.0.2<br>Jacoco 0.8.2</p><h3 id="1、属性注入"><a href="#1、属性注入" class="headerlink" title="1、属性注入"></a>1、属性注入</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.test.util.ReflectionTestUtils;<br><br>ReflectionTestUtils.setField(被测试类, <span class="hljs-string">&quot;属性名&quot;</span>, 属性实际值);<br></code></pre></td></tr></table></figure><h3 id="2、调用方法中有-new-操作"><a href="#2、调用方法中有-new-操作" class="headerlink" title="2、调用方法中有 new 操作"></a>2、调用方法中有 new 操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 类级别使用如下注解</span><br><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span><br><span class="hljs-comment">// 方法层使用如下注解</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-meta">@PrepareForTest(value = &#123;被测试类.class, 需要new的类.class&#125;)</span><br><br><span class="hljs-comment">// 例如：</span><br><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-meta">@PrepareForTest(value = &#123;Test.class, Date.class&#125;)</span> <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>        Date date = PoweerMockito.mock(Date.class);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            PowerMockito.whenNew(Date.class).withNoArguments().thenReturn(date);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3、静态方法"><a href="#3、静态方法" class="headerlink" title="3、静态方法"></a>3、静态方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 类级别使用如下注解</span><br><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span><br><span class="hljs-comment">// 方法层使用如下注解</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-meta">@PrepareForTest(value = &#123;被测试类.class, 需要使用的静态方法所属类.class&#125;)</span><br><br><span class="hljs-comment">// 例如：</span><br><br><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-meta">@PrepareForTest(value = &#123;Test.class, EncodeUtils.class&#125;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>        PowerMockito.mockStatic(EncodeUtils.class);<br>        PowerMockito.when(EncodeUtils.decript(passwd, key)).thenReturn(plainPwd);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4、一般方法"><a href="#4、一般方法" class="headerlink" title="4、一般方法"></a>4、一般方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// mock操作，提供</span><br>doReturn(xxx).when(mockXX).executeMethod();<br>doThrow(Exception.class)<br>doNothing()<br><br><span class="hljs-comment">// 验证</span><br>verify(mockXX, times(调用次数)).executeMethod()<br><br></code></pre></td></tr></table></figure><h3 id="5、单元测试使用PowerMockito时，jacoco覆盖率无法兼容解决"><a href="#5、单元测试使用PowerMockito时，jacoco覆盖率无法兼容解决" class="headerlink" title="5、单元测试使用PowerMockito时，jacoco覆盖率无法兼容解决"></a>5、单元测试使用PowerMockito时，jacoco覆盖率无法兼容解决</h3><p>参考 <a href="https://github.com/powermock/powermock-examples-maven/blob/master/jacoco-offline/pom.xml">https://github.com/powermock/powermock-examples-maven/blob/master/jacoco-offline/pom.xml</a><br>生成html覆盖报告，可以修改为如下内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;execution&gt;<br>  &lt;id&gt;report&lt;/id&gt;<br>  &lt;phase&gt;prepare-<span class="hljs-keyword">package</span>&lt;/phase&gt;<br>  &lt;goals&gt;<br>      &lt;goal&gt;report&lt;/goal&gt;<br>  &lt;/goals&gt;<br>  &lt;configuration&gt;<br>      &lt;dataFile&gt;$&#123;project.build.directory&#125;/coverage.exec&lt;/dataFile&gt;<br>      &lt;outputDirectory&gt;$&#123;basedir&#125;/target/coverage-reports&lt;/outputDirectory&gt;<br>  &lt;/configuration&gt;<br>&lt;execution&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>BufferedReader使用记录</title>
    <link href="/2021/12/06/2019-12-11-bufferedreader/"/>
    <url>/2021/12/06/2019-12-11-bufferedreader/</url>
    
    <content type="html"><![CDATA[<p>BufferedReader使用记录</p><p>一种以缓冲方式读取字符IO流，可以指定缓冲空间大小，默认为8192 </p><p>常见读取有如下三种方式：</p><h4 id="1、readline"><a href="#1、readline" class="headerlink" title="1、readline()"></a>1、readline()</h4><p>按行读取，解析IO流中的<code>\n</code>、<code>\r</code>、<code>\r\n</code>作为读取结束依据，不会解析字符串中的<code>\n</code>、<code>\r</code><br>以普通文件为例：按照回车符作为每一行的结束<br>以<code>shell</code>或<code>python</code>脚本为例：以每一个<code>echo</code>或者<code>print</code>或者<code>log</code>输出结束<br>示例：  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">String buffer;<br><span class="hljs-keyword">while</span> ((buffer = reader.readLine()) != <span class="hljs-keyword">null</span>) &#123;<br>    System.out.println(buffer);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2、read"><a href="#2、read" class="headerlink" title="2、read()"></a>2、read()</h4><p>一个字节一个的读取缓冲区，直到最后一个字节读取完成<br>示例：  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">int</span> size = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span> ((size = reader.read()) != -<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-comment">// 此处使用println时，会在每一个字符后换行，不是想要的结果</span><br>    System.out.print((<span class="hljs-keyword">char</span>)size);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3、read-char-targetCharArray-int-off-int-length"><a href="#3、read-char-targetCharArray-int-off-int-length" class="headerlink" title="3、read(char[] targetCharArray, int off, int length)"></a>3、read(char[] targetCharArray, int off, int length)</h4><p><code>targetCharArray</code>: 将读取到的内容存储到该字符数组，如果读取内容小于字符数组大小，会默认填充值，需要做处理<br><code>off</code>: 偏移量，从什么位置开始读取，一般设置为0，从原点读取，每次完整的读取一个<code>char</code>数组<br><code>length</code>：从缓冲区读取大小<br>示例：  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">int</span> size = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">char</span>[] readChar = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[<span class="hljs-number">1024</span>];  <span class="hljs-comment">// 字符数组大小自定义</span><br>String buffer = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">while</span> ((size = reader.read(readChar, <span class="hljs-number">0</span>, readChar.length)) != -<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-comment">// 读取到的内容小于自定义字符数组，需要去除默认填充值</span><br>    <span class="hljs-keyword">if</span> (size &lt; readChar.length) &#123;<br>        <span class="hljs-keyword">char</span>[] newReaderChar = Arrays.copyOf(readChar, size);<br>        buffer = String.valueOf(newReaderChar);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        buffer = String.valueOf(readChar);<br>    &#125;<br>    System.out.println(buffer);<br>&#125;<br></code></pre></td></tr></table></figure><p>完整示例请访问：<a href="https://github.com/duwei0227/java-demo/blob/master/src/main/java/top/probiecoder/BufferedReaderDemo.java">BufferedReader</a></p><p><strong>如有理解不对之处，请指出，谢谢。</strong></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Spring Boot JMS</title>
    <link href="/2021/12/06/2020-02-05-spring-jms/"/>
    <url>/2021/12/06/2020-02-05-spring-jms/</url>
    
    <content type="html"><![CDATA[<p>Spring Boot JMS</p><p>   使用spring-jms实现简单异步消息队列，用于异步通知以及异步事务处理。<br>项目：</p><ul><li>spring boot 2.2.2</li><li>基于内存模式的activiMQ消息队列</li><li>使用默认的Container</li></ul><h4 id="一、pom依赖"><a href="#一、pom依赖" class="headerlink" title="一、pom依赖"></a>一、pom依赖</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>    &lt;artifactId&gt;spring-boot-starter-activemq&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;<br>    &lt;artifactId&gt;activemq-broker&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;<br>    &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><h4 id="二、JMS-config配置"><a href="#二、JMS-config配置" class="headerlink" title="二、JMS config配置"></a>二、JMS config配置</h4><p>进行文本的序列化(使用jackson)，支持对象参数<br>自定义ContainerFactory(自定义配置以后，需要在Listener处指定containerFactory)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    自定义配置</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> JmsListenerContainerFactory&lt;?&gt; myFactory(ConnectionFactory connectionFactory,<br>                                                    DefaultJmsListenerContainerFactoryConfigurer configurer) &#123;<br>        DefaultJmsListenerContainerFactory factory = <span class="hljs-keyword">new</span> DefaultJmsListenerContainerFactory();<br>        configurer.configure(factory, connectionFactory);<br>        <span class="hljs-keyword">return</span> factory;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span> <span class="hljs-comment">// 序列化文本,可以支持对象参数</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> MessageConverter <span class="hljs-title">jacksonJmsMessageConverter</span><span class="hljs-params">()</span> </span>&#123;<br>        MappingJackson2MessageConverter converter = <span class="hljs-keyword">new</span> MappingJackson2MessageConverter();<br>        converter.setTargetType(MessageType.TEXT);<br>        converter.setTypeIdPropertyName(<span class="hljs-string">&quot;_type&quot;</span>);   <span class="hljs-comment">// 不能为空,反序列化为object时需要</span><br>        <span class="hljs-keyword">return</span> converter;<br>    &#125;<br></code></pre></td></tr></table></figure><h4 id="三、消息生产者"><a href="#三、消息生产者" class="headerlink" title="三、消息生产者"></a>三、消息生产者</h4><ul><li>destinationName 消息消费者名称  </li><li>parameter 消费者所需参数，可以为对象<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">private</span> JmsTemplate jmsTemplate;<br><br>jmsTemplate.convertAndSend(destinationName, parameter);<br></code></pre></td></tr></table></figure></li></ul><h4 id="四、消息消费者"><a href="#四、消息消费者" class="headerlink" title="四、消息消费者"></a>四、消息消费者</h4><ul><li>destination 定义消费者名称，用户生产者调用；必须</li><li>containerFactory 指定自定义Container; 可选<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@JmsListener(destination = &quot;mailbox&quot;, containerFactory = &quot;myFactory&quot;)</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="五、其他"><a href="#五、其他" class="headerlink" title="五、其他"></a>五、其他</h4><p>需要在启动类允许jms <code>@EnableJms</code></p>]]></content>
    
    
    <categories>
      
      <category>JMS</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>单例模式的RestTemplate</title>
    <link href="/2021/12/06/2019-12-13-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84RestTemplage/"/>
    <url>/2021/12/06/2019-12-13-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84RestTemplage/</url>
    
    <content type="html"><![CDATA[<p>单例模式的RestTemplate</p><p>在<code>Spring Boot</code> 升级到 <code>2.0</code> 以后，无法使用 <code>@Autowired</code> 直接注入 <code>RestTemplate</code> , 需要通过 <code>RestTemplateBuilder</code> 产生。基于此实现了一个单例模式的工具类，用于获取 <code>RestTemplate</code>，同时学习单例模式的写法。   </p><p>以下方法基于 <code>Spring Boot 2.1.5.RELEASE</code>测试通过</p><p>本文实现了三种方式：  </p><h4 id="1、线程安全的懒汉模式"><a href="#1、线程安全的懒汉模式" class="headerlink" title="1、线程安全的懒汉模式"></a>1、线程安全的懒汉模式</h4><p>由于方法锁的缘由，在并发访问的时候效率会降低</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestTemplateUtil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> RestTemplate restTemplate;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">RestTemplateUtil</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> RestTemplate <span class="hljs-title">getRestTemplate</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (restTemplate == <span class="hljs-keyword">null</span>) &#123;<br>            restTemplate = <span class="hljs-keyword">new</span> RestTemplateBuilder().builder();<br>        &#125;<br>        <span class="hljs-keyword">return</span> restTemplate;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2、饿汉模式"><a href="#2、饿汉模式" class="headerlink" title="2、饿汉模式"></a>2、饿汉模式</h4><p>在类加载的时候初始化，常驻内存</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestTemplateUtil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> RestTemplate restTemplate = <span class="hljs-keyword">new</span> RestTemplateBuilder().builder();<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">RestTemplateUtil</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> RestTemplate <span class="hljs-title">getRestTemplate</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> restTemplate;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3、枚举方式"><a href="#3、枚举方式" class="headerlink" title="3、枚举方式"></a>3、枚举方式</h4><p>推荐方法，参考《Effective Java》</p><ul><li>自有序列号  </li><li>保证只有一个实例  </li><li>线程安全</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">RestTemplateUtil</span> </span>&#123;<br>    INSTANCE;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> RestTemplate <span class="hljs-title">getRestTemplate</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RestTemplateBuilder().builder()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4、私有类模式"><a href="#4、私有类模式" class="headerlink" title="4、私有类模式"></a>4、私有类模式</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestTemplateUtil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LazySingleton</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Singleton INSTANCE = <span class="hljs-keyword">new</span> RestTemplateUtil();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> RestTemplateUtil <span class="hljs-title">getRestTemplateUtil</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> LazySingleton.INSTANCE;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>自定义处理RestTemplate非200响应</title>
    <link href="/2021/12/06/2019-12-13-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86RestTemplate%E9%9D%9E200%E5%93%8D%E5%BA%94/"/>
    <url>/2021/12/06/2019-12-13-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86RestTemplate%E9%9D%9E200%E5%93%8D%E5%BA%94/</url>
    
    <content type="html"><![CDATA[<p>自定义处理RestTemplate非200响应</p><p><code>RestTemplate</code>对非200错误的响应默认做了处理，会丢失很多信息。尤其接口方在抛出错误的时候，将错误信息放在响应体的中；<br>这个时候如果不对响应做自定义处理是无法拿到响应结果的。  </p><p>自定义处理方式：  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestTemplateResponseErrorHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ResponseErrorHandler</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasError</span><span class="hljs-params">(ClientHttpResponse response)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// 自定义响应码的正确性</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;   <span class="hljs-comment">// 认为所有结果都是正确的，转到上层处理</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleError</span><span class="hljs-params">(ClientHttpResponse response)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">//对错误的处理，可以不做任何处理</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Path 常用方法介绍</title>
    <link href="/2021/12/06/2020-02-20-%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/"/>
    <url>/2021/12/06/2020-02-20-%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p>Path 常用方法介绍</p><h3 id="一、Path"><a href="#一、Path" class="headerlink" title="一、Path"></a>一、Path</h3><h4 id="1、路径构建"><a href="#1、路径构建" class="headerlink" title="1、路径构建"></a>1、路径构建</h4><p>支持多级目录<br>当路径为相对路径时，构建的路径基于用于工作目录(<code>System.getProperty(&quot;user.dir&quot;)</code>);当路径为绝对路径时，构建的路径为绝对路径</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Paths.get(<span class="hljs-string">&quot;path&quot;</span>);<br>Paths.get(<span class="hljs-string">&quot;path&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br>Paths.get(<span class="hljs-string">&quot;/home&quot;</span>, <span class="hljs-string">&quot;path&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="2、resolve、resolveSibling组合路径"><a href="#2、resolve、resolveSibling组合路径" class="headerlink" title="2、resolve、resolveSibling组合路径"></a>2、<code>resolve</code>、<code>resolveSibling</code>组合路径</h4><p><code>this.resolve(other)</code>:<br><code>other</code>可以为<code>Path</code>也可以为字符路径  </p><ul><li>如果<code>other</code>是绝对路径，则结果就是<code>other</code></li><li>如果<code>other</code>是相对路径，则结果为 <code>this + other</code> 构成的路径<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">Path base = Paths.get(<span class="hljs-string">&quot;/home/path&quot;</span>);<br>Path target = base.resolve(<span class="hljs-string">&quot;work&quot;</span>);<br>输出：/home/path/work<br><br>Path base = Paths.get(<span class="hljs-string">&quot;/home/path&quot;</span>);<br>Path target = base.resolve(<span class="hljs-string">&quot;/home/work&quot;</span>);<br>输出：/home/work<br></code></pre></td></tr></table></figure></li></ul><p><code>this.resolveSibling(other)</code>:<br>解析指定路径的父路径产生其兄弟路径  </p><ul><li>如果<code>other</code>是绝对路径，则结果就是<code>other</code></li><li>如果<code>other</code>是相对路径，则结果为<code>this</code>的父路径拼接<code>other</code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">Path base = Paths.get(<span class="hljs-string">&quot;/home/path&quot;</span>);<br>Path target = base.resolveSibling(<span class="hljs-string">&quot;work&quot;</span>);<br>输出：/home/work<br><br>Path base = Paths.get(<span class="hljs-string">&quot;/home/path&quot;</span>);<br>Path target = base.resolveSibling(<span class="hljs-string">&quot;/home/work&quot;</span>);<br>输出：/home/work<br></code></pre></td></tr></table></figure></li></ul><h4 id="3、relativize相对路径解析"><a href="#3、relativize相对路径解析" class="headerlink" title="3、relativize相对路径解析"></a>3、<code>relativize</code>相对路径解析</h4><p>相对于<code>other</code>的路径，即有当前路径访问<code>other</code>的相对路径</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Path base = Paths.get(<span class="hljs-string">&quot;/home/path&quot;</span>);<br>Path other = Paths.get(<span class="hljs-string">&quot;/home/user/work&quot;</span>);<br>Path target = base.relativize(other);<br>输出：../user/work<br></code></pre></td></tr></table></figure><h4 id="4、toAbsolutePath转为绝对路径"><a href="#4、toAbsolutePath转为绝对路径" class="headerlink" title="4、toAbsolutePath转为绝对路径"></a>4、<code>toAbsolutePath</code>转为绝对路径</h4><p>生成的绝对路径可能会包含<code>.</code>,<code>..</code><br>例如基于<code>relativize</code>生成的绝对路径为:<code>/Users/user/Workspace/../user/work</code></p><h4 id="5、normalize路径格式化"><a href="#5、normalize路径格式化" class="headerlink" title="5、normalize路径格式化"></a>5、<code>normalize</code>路径格式化</h4><p>移除路径中的<code>.</code>,<code>..</code>等冗余的路径元素</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">对 /Users/user/Workspace/../user/work 执行normalize后 /Users/user/user/work<br></code></pre></td></tr></table></figure><h4 id="6、其他"><a href="#6、其他" class="headerlink" title="6、其他"></a>6、其他</h4><p><code>getParent</code>:返回父路径或者null<br><code>getFileName</code>:返回该路径的最后一个部件<br><code>getRoot</code>:返回该路径的根路径</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Java中的正则表达式</title>
    <link href="/2021/12/06/2020-02-20-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2021/12/06/2020-02-20-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p>Java中的正则表达式</p><h3 id="1、正则表达式语法"><a href="#1、正则表达式语法" class="headerlink" title="1、正则表达式语法"></a>1、正则表达式语法</h3><table><thead><tr><th>表达式</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td>字符</td><td></td><td></td></tr><tr><td><strong>.</strong></td><td>除换行符以外的任何字符，或者在DOTALL设置时表示任意字符</td><td>单独字符中的点不需要转义，后边跟着量词才有意义</td></tr><tr><td><code>\a,\e,\f,\n,\r,\t</code></td><td>响铃符，转义符，换页符，换行符，回车符，指标符</td><td>\n</td></tr><tr><td>字符类</td><td></td><td></td></tr><tr><td><code>[^...]</code></td><td>某个字符类的补集</td><td><code>[^\d\s]</code></td></tr><tr><td><code>[...&amp;&amp;...]</code></td><td>字符集的交集</td><td><code>[\p&#123;L&#125;&amp;&amp;[^A-Za-z]]</code></td></tr><tr><td><code>\d,\D</code></td><td>数字[0-9]\d+；它的补集</td><td></td></tr><tr><td><code>\w,\W</code></td><td>单词字符[a-zA-Z0-9]；它的补集</td><td></td></tr><tr><td><code>\s,\S</code></td><td>空白字符[ \n\r\t\f\x{8}]；他的补集</td><td></td></tr><tr><td><code>\h,\v,\H,\V</code></td><td>水平空白字符、垂直空白字符；他们的补集</td><td></td></tr><tr><td>群组</td><td></td><td></td></tr><tr><td><code>(X)</code></td><td>捕获X的匹配</td><td><code>([^&#39;]*)</code>捕获的是被引用的文本</td></tr><tr><td><code>\n</code></td><td>第<code>n</code>组</td><td><code>([&#39;&quot;]).*\1</code>可以匹配<code>&#39;Fred&#39;</code>和<code>&quot;Fred&quot;</code>,但是不能匹配<code>&quot;Fred&#39;</code></td></tr><tr><td>量词（默认为贪婪模式，尽可能的匹配）</td><td></td><td></td></tr><tr><td><code>X?</code></td><td>0或1次</td><td></td></tr><tr><td><code>X*</code></td><td>出现0次或多次</td><td></td></tr><tr><td><code>X+</code></td><td>至少出现一次</td><td></td></tr><tr><td><code>X&#123;n&#125;,X&#123;n,&#125;,X&#123;n,m&#125;</code></td><td>n个X，至少n个X，n到m个X</td><td></td></tr><tr><td><code>Q?</code>,其中Q是一个量词表达式</td><td>非贪婪模式，先尝试匹配最短模式,Q是一个无上限的量词</td><td><code>&#123;3&#125;</code>:只匹配<code>123</code>, <code>&#123;3,&#125;</code>:默认匹配全部<code>123...</code>，<code>&#123;3,&#125;</code>:匹配<code>123</code></td></tr><tr><td>边界匹配</td><td></td><td></td></tr><tr><td><code>^,$</code></td><td>输入的开头和结尾</td><td></td></tr><tr><td><code>\A,\Z,\z</code></td><td>输入的开头，输入的结尾，输入的绝对结尾</td><td></td></tr><tr><td><code>\b,\B</code></td><td>单词边界，非单词边界</td><td></td></tr><tr><td><code>R</code></td><td>Unicode行分隔符</td><td></td></tr><tr><td><code>\G</code></td><td>前一个匹配的结尾</td><td></td></tr><tr><td>其他</td><td></td><td></td></tr><tr><td><code>-</code></td><td>范围表示</td><td>0-3表示0，1，2，3</td></tr></tbody></table><h3 id="2、编译标志"><a href="#2、编译标志" class="headerlink" title="2、编译标志"></a>2、编译标志</h3><p><code>Pattern.compile(&quot;&quot;, Pattern.CASE_INSENSITIVE + Pattern.UNICODE_CASE)</code><br>标志|描述<br>-|-<br><code>Pattern.CASE_INSENSITIVE或r</code>|匹配字符时忽略字母的大小写，默认只考虑<code>US ASCII</code>字符|<br><code>Pattern.UNICODE_CASE</code>|与<code>CASE_INSENSITIVE</code>组合使用的时候，用<code>Unicode</code>字母的大小写来匹配|<br><code>Pattern.UNICODE_CHARACTER_CLASS或U</code>|选择<code>Unicode</code>字符类代替<code>POSIX</code>，其中蕴含了<code>UNICODE_CASE</code>|<br><code>Pattern.MULTILINE或m</code>|<code>^和$匹配行的开头和结尾，而不是整个输入的开头和结尾</code>|<br><code>Pattern.UNIX_LINES或d</code>|在多行模式中匹配<code>^</code>和<code>$</code>时，只有<code>\n</code>被识别成行终止符|<br><code>Pattern.DOTALL或s</code>|**.**匹配所有字符，包含行终止符|<br><code>Pattern.COMMENTS或x</code>|空白字符和注释(从#到行末尾)将被忽略|<br><code>Pattern.LITERAL</code>|该模式将被逐字地采纳，必须精确匹配，因字母大小写而造成的差异除外|<br><code>Pattern.CANON_EQ</code>|考虑<code>Unicode</code>字符规范的等价性|</p><h3 id="3、示例"><a href="#3、示例" class="headerlink" title="3、示例"></a>3、示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">String text = <span class="hljs-string">&quot;This is my personal info. My cellphone &quot;</span> +<br>                <span class="hljs-string">&quot;number 15301234567 and email probiecoder@gmail.com.Today i will learn regex&quot;</span>;<br></code></pre></td></tr></table></figure><h4 id="简单数值匹配"><a href="#简单数值匹配" class="headerlink" title="简单数值匹配"></a>简单数值匹配</h4><blockquote><p>默认模式-贪婪模式，尽可能的多匹配</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String regex  = <span class="hljs-string">&quot;\\d&#123;3,&#125;&quot;</span>;<br>Pattern pattern = Pattern.compile(regex);<br>Matcher matcher = pattern.matcher(text);<br><span class="hljs-keyword">if</span> (matcher.find()) &#123;<br>    System.out.println(matcher.group());<br>&#125;<br>输出:<span class="hljs-number">15301234567</span><br></code></pre></td></tr></table></figure><blockquote><p>非贪婪模式</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">修改 regex = <span class="hljs-string">&quot;\\d&#123;3,&#125;&quot;</span><br>输出:<span class="hljs-number">153</span><br></code></pre></td></tr></table></figure><h4 id="email匹配"><a href="#email匹配" class="headerlink" title="email匹配"></a>email匹配</h4><p>涉及到 <strong>或</strong> 的使用<br>限制email后缀 <code>gmail.com qq.com 163.com</code> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String regex = <span class="hljs-string">&quot;\\w&#123;3,&#125;@(gmail|qq|163).com&quot;</span>;<br>Pattern pattern = Pattern.compile(regex);<br>Matcher matcher = pattern.matcher(text);<br><span class="hljs-keyword">if</span> (matcher.find()) &#123;<br>    System.out.println(matcher.group());<br>&#125;<br>输出: probiecoder<span class="hljs-meta">@gmail</span>.com<br></code></pre></td></tr></table></figure><h4 id="限定字符匹配区域"><a href="#限定字符匹配区域" class="headerlink" title="限定字符匹配区域[]"></a>限定字符匹配区域<code>[]</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">[Jj]ava<br>匹配java、Java<br></code></pre></td></tr></table></figure><h4 id="分组匹配"><a href="#分组匹配" class="headerlink" title="分组匹配"></a>分组匹配</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">String text = <span class="hljs-string">&quot;java,Java,aJava,iJava&quot;</span>;<br>String regex = <span class="hljs-string">&quot;\\w+,(Java),aJava,(iJava)&quot;</span>;<br>Pattern pattern = Pattern.compile(regex);<br>Matcher matcher = pattern.matcher(text);<br><span class="hljs-keyword">if</span> (matcher.find()) &#123;<br>    System.out.println(matcher.group());   <span class="hljs-comment">// 输出整个匹配</span><br>    System.out.println(matcher.groupCount());  <span class="hljs-comment">// 匹配分组数</span><br>    System.out.println(matcher.group(<span class="hljs-number">1</span>));  <span class="hljs-comment">// 输出Java</span><br>    System.out.println(matcher.group(<span class="hljs-number">2</span>));  <span class="hljs-comment">// 输出iJava</span><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Java忽略https证书验证</title>
    <link href="/2021/12/06/2020-03-30-Java%E5%BF%BD%E7%95%A5https%E8%AF%81%E4%B9%A6%E9%AA%8C%E8%AF%81/"/>
    <url>/2021/12/06/2020-03-30-Java%E5%BF%BD%E7%95%A5https%E8%AF%81%E4%B9%A6%E9%AA%8C%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<p>Java忽略https证书验证</p><p>   项目开发过程中，尤其内部项目可能会用到自签名证书，这个时候就需要忽略对证书的验证。</p><p>版本环境：  </p><blockquote><p>jdk 1.8<br>httpclient-4.5.5</p></blockquote><p>示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> HttpComponentsClientHttpRequestFactory httpRequesetFactory;<br><br><span class="hljs-keyword">static</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        SSLContext sslContext = SSLContextBuilder.creaet()<br>                        .loadTrustMaterial(<span class="hljs-keyword">new</span> TrustAllStrategy());<br>                        .build();<br><br>        HostnameVerifier allowAllHosts = <span class="hljs-keyword">new</span> NoopHostnameVerifier();<br>        SSLConnectionSocketFactory factory = <span class="hljs-keyword">new</span> SSLConnectionSocketFactory(sslContext, allowAllHosts);<br><br>        CloseableHttpClient httpClient = HttpClients.custom()<br>                .setSSLSocketFactory(factory)<br>                .setMacConnTotal(<span class="hljs-number">1000</span>)<br>                .setMaxConnPerRoute(<span class="hljs-number">200</span>)  <span class="hljs-comment">// 单个路由地址请求并发数</span><br>                .build();<br><br>        httpRequesetFactory = <span class="hljs-keyword">new</span> HttpComponentsClientHttpRequestFactory(httpClient);<br>    &#125; <span class="hljs-keyword">catch</span> (Exeception e) &#123;<br>        log.error(e.getMessage, e);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Jmeter简单使用介绍</title>
    <link href="/2021/12/06/2020-03-07-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    <url>/2021/12/06/2020-03-07-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<p>Jmeter简单使用介绍</p><h3 id="一、准备"><a href="#一、准备" class="headerlink" title="一、准备"></a>一、准备</h3><p>新建个人工作空间<code>Workspace</code>，后续所有操作基于该目录  </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">Windows:</span> E:/Workspace<br><span class="hljs-symbol">Linux:</span> ~/Workspace<br></code></pre></td></tr></table></figure><h3 id="二、Jmeter使用"><a href="#二、Jmeter使用" class="headerlink" title="二、Jmeter使用"></a>二、Jmeter使用</h3><h4 id="1、安装jdk或者jre运行环境"><a href="#1、安装jdk或者jre运行环境" class="headerlink" title="1、安装jdk或者jre运行环境"></a>1、安装jdk或者jre运行环境</h4><h4 id="2、下载安装Jmeter"><a href="#2、下载安装Jmeter" class="headerlink" title="2、下载安装Jmeter"></a>2、下载安装Jmeter</h4><p>访问<a href="https://jmeter.apache.org/">https://jmeter.apache.org/</a>,选择左侧<code>Download Releases</code><br>选择下载<code>zip</code>文件<br><img src="/images/jmeter/jmeter-download.png" alt="jmeter-download"></p><h4 id="3、将jmeter解压到Workspace目录"><a href="#3、将jmeter解压到Workspace目录" class="headerlink" title="3、将jmeter解压到Workspace目录"></a>3、将<code>jmeter</code>解压到<code>Workspace</code>目录</h4><p><code>Windows</code>平台使用解压工具(Winrar,7Zip…)<br><code>Linux</code>平台:<code>unzip apache-jmeter-xxxx.zip</code></p><h4 id="4、运行jmeter"><a href="#4、运行jmeter" class="headerlink" title="4、运行jmeter"></a>4、运行<code>jmeter</code></h4><p>进入解压后的<code>jmeter/bin</code>目录<br><code>Windows</code>：运行<code>jmeter.bat</code><br><code>Linux</code>：<code>./jmeter.sh</code>如果无执行权限，运行 <code>chmod +x jmeter.sh</code></p><h4 id="5、运行测试集"><a href="#5、运行测试集" class="headerlink" title="5、运行测试集"></a>5、运行测试集</h4><ol><li><p>新建线程组<br><img src="/images/jmeter/thread-group.png" alt="线程组"></p></li><li><p>线程组属性配置<br>设置线程组名称<br>执行测试单元失败后的行为<br>线程数，循环次数– 并发场景测试<br><img src="/images/jmeter/thread-group-setting.png" alt="线程组属性"></p></li><li><p>保存测试计划，生成<code>jmx</code>文件<br>将文件保存到<code>Workspace/jmeter</code>  </p></li><li><p>设置http请求默认值<br>一些默认的协议、地址、端口等通用配置<br><img src="/images/jmeter/request-default.png"><br><img src="/images/jmeter/request-default-value.png"></p></li><li><p>添加HTTP信息头管理器<br>header通用参数，例如<code>Content-Type</code>,<code>Authorization</code></p></li></ol><p><img src="/images/jmeter/header-add.png"></p><p><img src="/images/jmeter/header.png"></p><ol start="6"><li><p>添加HTTP请求<br>不需要执行的HTTP请求可以禁用<br>此处根据接口定义选择对应的方法，常用有<code>GET POST DELTE PUT</code>，由于前边已经配置请求默认值，此处可以不用重复配置地址、端口、编码信息<br><img src="/images/jmeter/http-request.png"><br><img src="/images/jmeter/get.png"><br>请求参数格式为<code>json</code>对象示例：<br><img src="/images/jmeter/add.png"></p></li><li><p>添加查看结果树<br>结果树红色为请求错误，绿色为请求正确<br>检测请求结果日志，通过观察结果树，可以查看到请求参数以及相应内容<br><img src="/images/jmeter/request-result.png"><br>请求参数查看：<br><img src="/images/jmeter/result-request.png"><br>请求参数错误，请求错误返回错误信息，可以在此处查看原因<br><img src="/images/jmeter/result-response-error.png"><br>通过结果树中的日志可以确认接口是由于header中未设置<code>Content-Type</code>导致，增加后重新测试可以得到正确结果<br><img src="/images/jmeter/request-response-success.png"></p></li><li><p>结果断言<br>对请求成功的接口响应内容是否合法，符合预期做判断(http请求成功，不代表接口执行成功)<br><img src="/images/jmeter/assert.png"></p></li></ol><ul><li>响应断言 对结果文本代码等做判断  </li><li>JSON断言–返回结果为json时<br><img src="/images/jmeter/json-assert.png"></li></ul><ol start="9"><li>自定义变量<br>借助自定义变量可以将一些通用配置放置到外部文件中，例如用户名、密码<br>自定义变量取值方式：<code>$&#123;参数名&#125;</code><br>此处可以借助<code>jmeter</code>内置函数<code>__CSVReader</code>读取<code>csv</code>文本格式数据,在自定义变量中设置值为内置函数字符串时，可能存在读取换行问题，需要手动增加<code>next</code><br>可以通过将<code>csv</code>路径和取值列索引作为自定义参数(避免路径出现在多个地方，后期修改不方便)，在参数实际使用位置替换即可，并且可以实现自动读取下一行，示例如下：<br><img src="/images/jmeter/custom_params.png"><br><img src="/images/jmeter/csvreader.png">  </li></ol>]]></content>
    
    
    <categories>
      
      <category>自动化</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Selenium简单使用介绍</title>
    <link href="/2021/12/06/2020-03-07-selenium%E4%BD%BF%E7%94%A8/"/>
    <url>/2021/12/06/2020-03-07-selenium%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>Selenium简单使用介绍</p><p>部分测试基于百度首页</p><p>本地html读取方式<code>driver.get(&#39;file:///Workspace/static-web/selenium.html&#39;) </code>  </p><p>以下内容基于:<br><code>Python 3.7.4</code><br><code>selenium 3.141.0</code><br><code>Chrome 80.0.3987.132 64bit</code></p><h3 id="一、安装准备"><a href="#一、安装准备" class="headerlink" title="一、安装准备"></a>一、安装准备</h3><ul><li><code>python</code>模块安装<blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install selenium<br>conda install selenium<br></code></pre></td></tr></table></figure></blockquote></li><li><code>WebDriver</code>下载安装<blockquote><p><a href="https://chromedriver.storage.googleapis.com/index.html" target="_blank">Google</a> 驱动版本需要与浏览器版本对应<br><a href="https://github.com/mozilla/geckodriver/releases" target="_blank">Firefox</a></p></blockquote></li><li>驱动识别引入<blockquote><p>将文件路径添加到系统环境变量 <code>PATH</code>中<br>直接将驱动文件放置到python安装目录下的 <code>bin</code> 目录中</p></blockquote></li></ul><h3 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h3><h4 id="1、控制并打开浏览器窗口"><a href="#1、控制并打开浏览器窗口" class="headerlink" title="1、控制并打开浏览器窗口"></a>1、控制并打开浏览器窗口</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><br><span class="hljs-number">1</span>、selenium版本较高时，推荐使用，避免测试结束忘记关闭<br><span class="hljs-keyword">with</span> webdriver.Chrome() <span class="hljs-keyword">as</span> driver:<br>    driver.get(<span class="hljs-string">&quot;http://www.baidu.com&quot;</span>)<br><br><span class="hljs-number">2</span>、学习阶段建议使用，可以观察到某些变化<br>driver = webdriver.Chrome()<br>driver.get(<span class="hljs-string">&quot;htttp://www.baidu.com&quot;</span>)<br>driver.close()<br></code></pre></td></tr></table></figure><h4 id="2、元素定位"><a href="#2、元素定位" class="headerlink" title="2、元素定位"></a>2、元素定位</h4><p>推荐顺序 id &gt; css 选择器<br><code>XPATH</code>定位准确编写复杂且不利于<code>debug</code><br>链接文本(部分)只适用于 <code>a</code> 链接元素</p><p>以下内容返回第一个匹配的元素，适用<code>find_elements_xx</code>可返回多个元素<br>|定位元素|示例|使用方式|<br>-|-|-<br>class名称|<code>class=&quot;index-logo-src&quot;</code>|<code>driver.find_element_by_class_name(&#39;index-logo-src&#39;)</code><br>css选择器|<code>#lg .index-logo-src</code>|<code>driver.find_element_by_css_selector(&#39;#lg .index-logo-src&#39;)</code><br>id|<code>#lg</code>|<code>driver.find_element_by_id(&#39;#lg&#39;)</code><br>name|<code>name=&quot;mp&quot;</code>|<code>driver.find_element_by_name(&#39;mp&#39;)</code><br>链接部分显示不符|<code>&lt;a&gt;更多产品&lt;/a&gt;</code>|<code>driver.find_element_by_link_text(&#39;更多产品&#39;)</code><br>链接文本部分|<code>&lt;a&gt;更多产品&lt;/a&gt;</code>|<code>driver.find_element_by_partial_link_text(&#39;更多&#39;)</code><br>tag标签|<code>&lt;map&gt;&lt;/map&gt;</code>|<code>driver.find_element_by_tag_name(&#39;map&#39;)</code><br>xpath选择|<code>class=&quot;index-logo-src&quot;</code>|<code>driver.find_element_by_xpath(&#39;//div//img[@class=&quot;index-logo-src&quot;]&#39;)</code></p><h4 id="3、控制浏览器"><a href="#3、控制浏览器" class="headerlink" title="3、控制浏览器"></a>3、控制浏览器</h4><table><thead><tr><th>操作</th><th>方法</th></tr></thead><tbody><tr><td>打开浏览器</td><td><code>driver.get(&#39;http://www.baidu.com&#39;)</code></td></tr><tr><td>当前地址</td><td><code>driver.current_url</code></td></tr><tr><td>前进</td><td><code>driver.forward()</code></td></tr><tr><td>后退</td><td><code>driver.back()</code></td></tr><tr><td>刷新</td><td><code>driver.refresh()</code></td></tr><tr><td>标题</td><td><code>driver.title</code></td></tr><tr><td>当前窗口<code>handle</code></td><td><code>driver.current_window_handle</code></td></tr><tr><td>退出</td><td><code>driver.quit()</code></td></tr><tr><td>窗口大小</td><td><code>driver.get_window_size().get(&quot;width&quot;)</code> <code>height</code></td></tr><tr><td>重置窗口</td><td><code>driver.set_window_size(1024, 768)</code></td></tr><tr><td>窗口位置</td><td><code>driver.get_window_position().get(&#39;x&#39;)</code></td></tr><tr><td>设置窗口位置</td><td><code>driver.set_window_position(0, 0)</code></td></tr><tr><td>窗口最大化</td><td><code>driver.maximize_window()</code></td></tr><tr><td>全屏</td><td><code>driver.fullscreen_window()</code></td></tr></tbody></table><p>切换窗口 – 官网示例<br>如果点击链接后会打开新的<code>tab</code>窗口，必须要切换窗口，<code>driver</code>才会跟着切换到新的窗口</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.support.ui <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> EC<br><br><span class="hljs-comment"># Start the driver</span><br><span class="hljs-keyword">with</span> webdriver.Firefox() <span class="hljs-keyword">as</span> driver:<br>    <span class="hljs-comment"># Open URL</span><br>    driver.get(<span class="hljs-string">&quot;https://seleniumhq.github.io&quot;</span>)<br><br>    <span class="hljs-comment"># Setup wait for later</span><br>    wait = WebDriverWait(driver, <span class="hljs-number">10</span>)<br><br>    <span class="hljs-comment"># Store the ID of the original window</span><br>    original_window = driver.current_window_handle<br><br>    <span class="hljs-comment"># Check we don&#x27;t have other windows open already</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(driver.window_handles) == <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># Click the link which opens in a new window</span><br>    driver.find_element_by_link_text(<span class="hljs-string">&quot;new window&quot;</span>).click()<br><br>    <span class="hljs-comment"># Wait for the new window or tab</span><br>    wait.until(EC.number_of_windows_to_be(<span class="hljs-number">2</span>))<br><br>    <span class="hljs-comment"># Loop through until we find a new window handle</span><br>    <span class="hljs-keyword">for</span> window_handle <span class="hljs-keyword">in</span> driver.window_handles:<br>        <span class="hljs-keyword">if</span> window_handle != original_window:<br>            driver.switch_to.window(window_handle)<br>            <span class="hljs-keyword">break</span><br><br>    <span class="hljs-comment"># Wait for the new tab to finish loading content</span><br>    wait.until(EC.title_is(<span class="hljs-string">&quot;SeleniumHQ Browser Automation&quot;</span>))<br>  <br></code></pre></td></tr></table></figure><h4 id="4、等待"><a href="#4、等待" class="headerlink" title="4、等待"></a>4、等待</h4><p>等待期望元素加载完成。默认等待策略检测<code>document.readyState</code>状态变为<code>complete</code>，此时如果有<code>script</code>脚本创建元素，可能会出现无法定位到的情况</p><ul><li><p>显示等待</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">10</span>:等待时间 秒<br>WebDriverWait(driver, timeout=<span class="hljs-number">10</span>).until(<span class="hljs-keyword">lambda</span> d: d.find_element_by_class_name(<span class="hljs-string">&#x27;index-logo-src&#x27;</span>))<br></code></pre></td></tr></table></figure><p>  等待条件<br>  详情见<code>from selenium.webdriver.support import expected_conditions</code></p><blockquote><p>弹窗 - 警告 提示 确认<br>元素存在<br>元素可见<br>标题包含<br>标题是  </p></blockquote></li><li><p>隐式等待<br>适合于明确页面元素加载需要一定时间</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">driver = webdriver.Chrome()<br>driver.implicitly_wait(<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure></li><li><p>FluentWait<br>可以配置等待时间，检查频率以及对某些异常的忽略  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">wait = WebDriverWait(driver, timeout=<span class="hljs-number">10</span>, poll_frequency=<span class="hljs-number">1</span>, ignored_exceptions=NoSuchElementException)<br>wait.until(EC.element_to_be_clickable(By.XPATH, <span class="hljs-string">&quot;//div&quot;</span>))<br></code></pre></td></tr></table></figure><h4 id="5、JavaScript弹窗"><a href="#5、JavaScript弹窗" class="headerlink" title="5、JavaScript弹窗"></a>5、<code>JavaScript</code>弹窗</h4><p>识别<code>JavaScript</code>弹出的<code>警告、确认、提示</code></p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">alert = wait.until(EC.alert_is_present())<br>// 警告 alert()<br>text = alert.text  <span class="hljs-comment"># 弹窗文本</span><br>alert.accept()  <span class="hljs-comment"># 确认</span><br><br>// 确认 confirm()<br>text = alert.text  <span class="hljs-comment"># 弹窗文本</span><br>alert.accept()  <span class="hljs-comment"># 确认</span><br>alert.dismiss()  <span class="hljs-comment"># 取消</span><br><br>// 提示框 prompt() 需要输入文本<br>alert = Alert(driver)<br>alert.send_keys(<span class="hljs-string">&quot;Selenium&quot;</span>)  <span class="hljs-comment"># 测试时在chrome未生效</span><br>alert.accept()<br></code></pre></td></tr></table></figure></li></ul><h4 id="6、系统键"><a href="#6、系统键" class="headerlink" title="6、系统键"></a>6、系统键</h4><p><code>ActionChains</code>需要使用<code>perform()</code>才会生效<br><strong>send_keys:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys<br><br>driver = webdriver.Chrome()<br>driver.get(<span class="hljs-string">&#x27;http://www.baidu.com&#x27;</span>)<br>driver.find_element_by_id(<span class="hljs-string">&#x27;kw&#x27;</span>).send_keys(<span class="hljs-string">&#x27;selenium&#x27;</span> + Keys.ENTER)<br></code></pre></td></tr></table></figure><p><strong>keyDown:模拟按下修改键（CONTROL，SHIFT，ALT）的动作</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">action = webdriver.ActionChains(driver)<br><br>action.key_down(Keys.CONTROL).send_keys(<span class="hljs-string">&quot;a&quot;</span>).perform()<br></code></pre></td></tr></table></figure><p><strong>keyUp:模拟修改键（CONTROL，SHIFT，ALT）的向上（或）释放操作</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">search = driver.find_element_by_id(<span class="hljs-string">&#x27;kw&#x27;</span>)<br>action.key_down(Keys.SHIFT)\<br>    .send_keys_to_element(search, <span class="hljs-string">&#x27;qwerty&#x27;</span>)\<br>    .key_up(Keys.SHIFT)\<br>    .send_keys(<span class="hljs-string">&#x27;qwerty&#x27;</span>)\<br>    .perform()<br><br>传入内容：QWERTYqwerty<br></code></pre></td></tr></table></figure><p><strong>clear:清空文本</strong>  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">search.clear()<br></code></pre></td></tr></table></figure><h4 id="7、示例"><a href="#7、示例" class="headerlink" title="7、示例"></a>7、示例</h4><p>以百度搜索，进入百度翻译，并修改翻译内容为例</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys<br><span class="hljs-keyword">from</span> selenium.webdriver.support.ui <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> EC<br><span class="hljs-keyword">from</span> selenium.webdriver.common.action_chains <span class="hljs-keyword">import</span> ActionChains<br><br>driver = webdriver.Chrome()<br><br>driver.get(<span class="hljs-string">&#x27;http://www.baidu.com&#x27;</span>)<br>driver.maximize_window()<br><span class="hljs-comment"># driver.implicitly_wait(5)  # 隐式等待 不要和显示等待混用</span><br><br><span class="hljs-comment"># 返回单个元素</span><br>driver.find_element_by_id(<span class="hljs-string">&#x27;kw&#x27;</span>)\<br>    .send_keys(<span class="hljs-string">&#x27;qwerty&#x27;</span> + Keys.ENTER)<br><br>wait = WebDriverWait(driver, timeout=<span class="hljs-number">10</span>)  <span class="hljs-comment"># 显示等待 超时10秒</span><br><br>wait.until(EC.title_contains(<span class="hljs-string">&#x27;qwerty&#x27;</span>))<br><br>divs = driver.find_elements_by_css_selector(<span class="hljs-string">&#x27;#content_left div&#x27;</span>)  <span class="hljs-comment"># 返回list</span><br><br>ele = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> divs:<br>    text = div.text<br>    <span class="hljs-comment"># 匹配需要的元素</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Qwerty_百度翻译&#x27;</span> <span class="hljs-keyword">in</span> text:<br>        ele = div<br>        <span class="hljs-keyword">break</span><br><br>a = ele.find_element_by_partial_link_text(<span class="hljs-string">&#x27;百度翻译&#x27;</span>)<br><span class="hljs-built_in">print</span>(a.get_attribute(<span class="hljs-string">&#x27;href&#x27;</span>))<br><br>origin_window = driver.current_window_handle  <span class="hljs-comment"># 获取当前窗口</span><br>a.click()<br><br><span class="hljs-comment"># 迭代所有窗口,窗口切换,切换driver指向, 按需求保存窗口</span><br><span class="hljs-keyword">for</span> win <span class="hljs-keyword">in</span> driver.window_handles:<br>    <span class="hljs-built_in">print</span>(win)  <br>    <span class="hljs-keyword">if</span> win != origin_window:<br>        driver.switch_to.window(win)<br><br>wait.until(EC.title_is(<span class="hljs-string">&#x27;百度翻译&#x27;</span>))<br><br><span class="hljs-comment"># 如果不做窗口切换,driver指向的还是上一个窗口</span><br><span class="hljs-built_in">input</span> = driver.find_element_by_id(<span class="hljs-string">&#x27;baidu_translate_input&#x27;</span>)<br><span class="hljs-built_in">input</span>.clear()  <span class="hljs-comment"># 清空</span><br><span class="hljs-comment"># input.send_keys(&#x27;baidu&#x27;)</span><br><br><span class="hljs-comment"># 此处需要使用perform后才会生效</span><br>action = ActionChains(driver)<br>action.key_down(Keys.SHIFT).send_keys_to_element(<span class="hljs-built_in">input</span>, <span class="hljs-string">&#x27;baidu&#x27;</span>).perform()<br><br>driver.close()  <span class="hljs-comment"># 关闭翻译链接新创建窗口,如果需要继续使用旧的窗口,需要进行switch_to</span><br>driver.switch_to.window(origin_window)<br>driver.close()  <span class="hljs-comment"># 关闭初始创建窗口</span><br>driver.quit() <span class="hljs-comment"># 观察效果的时候需要注释   关闭窗口并且推出webdriver execute</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>自动化</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
